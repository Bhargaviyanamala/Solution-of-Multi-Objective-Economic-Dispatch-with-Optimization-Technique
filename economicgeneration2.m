
function[Fa PgW Pl  PTW  F2]=economicgeneration(x)






data=[0.12951    40.5407    1000.403    33  0.0174  10  55 
    0.10908     39.5804     950.606     25  0.0178  20  80
     0.12511    36.5104     900.705     32  0.0162  47  120 
    0.12111     39.5104     800.705     30  0.0168  20  130
    0.15247     38.539      756.799     30  0.0148  50  160 
    0.10587     46.1592     451.325     20  0.0163  70  240 
    0.03546     38.3055     1243.531    20  0.0152  60  300 
    0.02803     40.3965     1049.998    30  0.0128  70  340
    0.02111     36.3278     1658.569    60  0.0136  135 470
    0.01799     38.2704     1356.659    40  0.0141  150  470];


emission=[0.00470   -3.9864     360.0012    0.25475     0.01234	     
      0.04652   -3.9524     350.0056    0.25475     0.01234          
      0.04652   -3.9023     330.0056    0.25163     0.01215
      0.04652   -3.9023     330.0056    0.25163     0.01215
      0.0042    0.3277      13.8593     0.2497      0.012
      0.0042    0.3277      13.8593     0.2497      0.012
      0.0068    -0.5455     40.2669     0.248       0.0129
      0.0068    -0.5455     40.2669     0.2499      0.01203
      0.0046    -0.5112     42.8955     0.2547      0.01234
      0.0046    -0.5112     42.8955     0.2547      0.01234];



B=0.0001*[0.49       0.14       0.15      0.15      0.16   0.17    0.17    0.18    0.19    0.20
            0.14     0.45    0.16    0.16    0.17    0.15    0.15    0.16    0.18    0.18
            0.15    0.16    0.39    0.10    0.12    0.12    0.14    0.14    0.16    0.16
            0.15    0.16    0.10    0.40    0.14    0.10    0.11    0.12    0.14    0.15
            0.16    0.17    0.12    0.14    0.35    0.11    0.13    0.13    0.15    0.16
            0.17    0.15    0.12    0.10    0.11    0.36    0.12    0.12    0.14    0.15    
            0.17    0.15    0.14    0.11    0.13    0.12    0.38    0.16    0.16    0.18
            0.18    0.16    0.14    0.12    0.13    0.12    0.16    0.40    0.15    0.16
            0.19    0.18    0.16    0.14    0.15    0.14    0.16    0.15    0.42    0.19
            0.20    0.18    0.16    0.15    0.16    0.15    0.18    0.16    0.19    0.44];

        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
       
 
Pd=2000;
WP=17+rand;
x=abs(x);
n=length(data(:,1));
for i=1:n-1
    if x(i)>1;
        x(i)=1;
    else
    end
    P(i)=data(i+1,6)+x(i)*(data(i+1,7)-data(i+1,6));
end
B11=B(1,1);
B1n=B(1,2:n);
Bnn=B(2:n,2:n);
A=B11;
BB1=2*B1n*P';
B1=BB1-1;
C1=P*Bnn*P';
C=Pd-sum(P)+C1-WP;
x1=roots([A B1 C]);
 x=abs(min(x1));
 if x>data(1,7)
     x=data(1,7);
 else
 end
   if x<data(1,6)
x=data(1,6);
   else
   end
 Pg=[x P];
 PT=sum(Pg);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
       Pl=Pg*B*Pg';
lam=abs(sum(Pg)+WP-Pd-Pg*B*Pg');
 PT=sum(Pg)+lam;
for i=1:n
   
 F1(i)=data(i,1)* Pg(i)^2+data(i,2)*Pg(i)+data(i,3)+data(i,4)*sin(data(i,5)*(data(i,6)-Pg(i)));
  F2(i)=emission(i,1)* Pg(i)^2+emission(i,2)*Pg(i)+emission(i,3)+emission(i,4)*exp(emission(i,5)*Pg(i));
end

      PgW=[x P WP];
PTW=PT+WP;
 F1=sum( F1);
 F2=sum(F2)+100*lam;
 Fa=sum(F1)+100*lam;
 



 
 

 
 
 
 
 
 
 
